//! In The Name Of Allah

#include <bits/stdc++.h>
using namespace std;

#define int long long
#define endl '\n'
#define pb push_back
#define pob pop_back
#define make M
#define F first
#define S second
#define all(s) (s).begin(), (s).end()
#define rall(s) s.rbegin(), s.rend()
#define sz(x) (int)x.size()
#define mem(a, b) memset(a, b, sizeof(a))
#define cnt_bit(x) __builtin_popcountll(x)
#define getbit(n, i) (((n) & (1LL << (i))) != 0)
#define msb(x) 64 - __builtin_clzll(x)
#define setbit(n, i) ((n) |= (1LL << (i)))
#define hoise cout << "Hoise" << endl;
#define tham getchar();
#define TxtIO                         \
    freopen("sample.in", "r", stdin); \
    freopen("sample.out", "w", stdout);
#define Fokinnir_moto_kaj_koris_na \
    ios_base::sync_with_stdio(0);  \
    cin.tie(0);                    \
    cout.tie(0);
#define py cout << "YES" << endl
#define pn cout << "NO" << endl
#define PI acos(-1)
#define sum_of(A) accumulate(all(A), 0ll)
#define max_of(A) *max_element(all(A))
#define min_of(A) *min_element(all(A))

typedef long long ll;
typedef double dl;
typedef vector<int> vi;
typedef vector<vi> vvi;
typedef pair<int, int> pii;
typedef vector<pii> vii;
typedef array<int,3> tu;

ll gcd(ll a, ll b) { return __gcd(a, b); }
ll lcm(ll a, ll b) { return a * (b / gcd(a, b)); }

/*
auto Goriber_function = [&] (int m) -> int{

};
*/

const ll oo = 1e18;
const ll mod = 1e9 + 7;
const ll N = 1e6 + 123;
int phi[N];
bool mark[N];
void sieve(){
    for(int i = 1; i < N; i++){
        phi[i] = i;
    }
    for(int i = 2; i < N; i++){
        if(mark[i])continue;
        phi[i] = i - 1;
        for(int j = i + i; j < N; j += i){
            mark[j] = true;
            phi[j] -= phi[j] / i;
        }
    }
}
int laser[N],col[N],fact[N];
int power(int a,int b,int mod){
    int ans = 1;
    a %= mod;
    while(b > 0){
        if(b & 1){
            ans = (ans * a) % mod;
        }
        a = (a * a) % mod;
        b >>= 1;
    }
    return ans % mod;
}
void pre(){
    fact[0] = 1;
    for(int i = 1; i < N; i++){
        fact[i] = (fact[i-1] * i) % mod;
    }
    for(int i = 1; i < N; i++){
        laser[i] = (laser[i-1] + phi[i] * 6) % mod;
    }
    col[0] = 0;
    for(int i = 1; i < N; i++){
        col[i] = (i * 6) + col[i-1];
    }
}

int nCr(int n,int k){
    if(n < k)return 0ll;
    int up = fact[n];
    int down = (fact[k] * fact[n-k]) % mod;
    down = power(down,mod-2,mod);
    int res = (up * down) % mod;
    return res;
}
void Goriber_solve()
{
    int n,k;
    cin >> n >> k;
    int lo = 1,hi = N - 2,ind = N - 2;
    while(lo <= hi){
        int mid = (lo + hi)/2;
        if(col[mid] >= k){
            ind = mid;
            hi = mid - 1;
        }
        else lo = mid + 1;
    }
    int now = k - col[ind - 1] - 1;
    int r = now % ind;
    cout << laser[n] << " " << nCr(ind,r) << endl;
}

signed main()
{
    Fokinnir_moto_kaj_koris_na
    sieve();
    pre();
    int _ = 1,tc = 0;
    cin >> _;
    while (_--)
    {
        //cout<<"Case "<<++tc<<": ";
        Goriber_solve();
    }
    return 0;
}

    
