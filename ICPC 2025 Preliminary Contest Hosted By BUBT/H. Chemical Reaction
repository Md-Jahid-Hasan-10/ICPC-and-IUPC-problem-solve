#include <bits/stdc++.h>
using namespace std;
#define quick_attack ios_base::sync_with_stdio(0);cin.tie(0);cout.tie(0)
#define endl "\n"
#define int long long
#define ll long long
#define ff first
#define ss second
#define pr pair<int,int>
//#define prr pair<pr,int>
const ll INF=1e15;
const ll mod = 998244353;




void solve(int  test)
{
    int n,m;cin>>n>>m;
    int A[n],B[m][3];
    for(int i=0;i<n;i++)cin>>A[i];
    for(int i=0;i<m;i++) cin>>B[i][0]>>B[i][1]>>B[i][2];
    map<int,int>U;
    int cu=0;
    for(int i=0;i<n;i++)
    {
        if(U.count(A[i])==0)
        {
            cu++;
            U[A[i]]=cu;
        }
        A[i]=U[A[i]];
    }
    for(int i=0;i<m;i++)
    {
        for(int j=0;j<3;j++){
            if(U.count(B[i][j])==0)
            {
                    cu++;
                U[B[i][j]]=cu;
            }
            B[i][j]=U[B[i][j]];
        }
    }

    vector<vector<int>>VV(cu+1,vector<int>(0,0));
    for(int i=0;i<m;i++)
    {
        VV[B[i][0]].push_back(B[i][2]);
        VV[B[i][1]].push_back(B[i][2]);
    }

    vector<int>V(cu+1,2) ,W(cu+1,2);
    queue<int>Q;
    for(int i=0;i<n;i++)Q.push(A[i]);

    while(Q.size())
    {
        int u=Q.front();
        Q.pop();
        if(V[u]==1) continue;
        V[u]=1;
        for(auto v:VV[u])
        {
            if(W[v]>0) W[v]--;
            if(W[v]==0)Q.push(v);
        }
    }
    int ans=0;
    for(int i=0;i<=cu;i++)ans+=V[i]==1;
    cout<<ans<<endl;
}

signed main()
{
    quick_attack;

    int t = 1;
    cin >> t;
    for (int i = 1; i <= t; i++)
        solve(i);
    return 0;
}
